{"ast":null,"code":"import _toConsumableArray from\"C:\\\\Users\\\\VASILISVITTIS\\\\Documents\\\\main\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";import _regeneratorRuntime from\"C:\\\\Users\\\\VASILISVITTIS\\\\Documents\\\\main\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"C:\\\\Users\\\\VASILISVITTIS\\\\Documents\\\\main\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"C:\\\\Users\\\\VASILISVITTIS\\\\Documents\\\\main\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\Users\\\\VASILISVITTIS\\\\Documents\\\\main\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _inherits from\"C:\\\\Users\\\\VASILISVITTIS\\\\Documents\\\\main\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"C:\\\\Users\\\\VASILISVITTIS\\\\Documents\\\\main\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import classes from'./PostSection.module.css';import React,{Component,useEffect}from'react';import Web3 from'web3';import{Container,Col,FloatingLabel,FormControl,Row}from'react-bootstrap';import CardFormatter from\"../ui/CardFormatter\";import Blog from'../../abis/Blog.json';import PostList from\"./PostList\";import NavigationBar from\"../layout/Navbar\";import Banner from\"../layout/Banner\";import Form from\"../ui/Form\";var PostSection=/*#__PURE__*/function(_Component){_inherits(PostSection,_Component);var _super=_createSuper(PostSection);function PostSection(props){var _this;_classCallCheck(this,PostSection);_this=_super.call(this,props);_this.state={userConnected:false,blogPost:null,postCount:0,posts:[],loading:true};// this.createPost = this.createPost.bind(this)\n// this.tipPost = this.tipPost.bind(this)\nreturn _this;}_createClass(PostSection,[{key:\"componentWillMount\",value:function(){var _componentWillMount=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return this.fetchData();case 2:case\"end\":return _context.stop();}}},_callee,this);}));function componentWillMount(){return _componentWillMount.apply(this,arguments);}return componentWillMount;}()},{key:\"fetchData\",value:function(){var _fetchData=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var web3,networkId,networkData,blogPost,postCount,i,post;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!window.ethereum){_context2.next=29;break;}window.web3=new Web3(window.ethereum);// } else if (window.web3) {\n//     window.web3 = new Web3(window.web3.currentProvider)\n// }\nconsole.log('use effect');web3=window.web3;_context2.next=6;return web3.eth.net.getId();case 6:networkId=_context2.sent;console.log(networkId.toString());networkData=Blog.networks[networkId];console.log(networkData);if(!networkData){_context2.next=29;break;}blogPost=new web3.eth.Contract(Blog.abi,networkData.address);this.setState({blogPost:blogPost});_context2.next=15;return blogPost.methods.postCount().call();case 15:postCount=_context2.sent;this.setState({postCount:postCount});console.log(\"Number of Posts: \"+postCount);// Load Posts\ni=1;case 19:if(!(i<=postCount)){_context2.next=27;break;}_context2.next=22;return blogPost.methods.posts(i).call();case 22:post=_context2.sent;this.setState({posts:[].concat(_toConsumableArray(this.state.posts),[post])});case 24:i++;_context2.next=19;break;case 27:// Sort posts. Show highest tipped posts first\nthis.setState({posts:this.state.posts.sort(function(a,b){return b.tipAmount-a.tipAmount;})});this.setState({loading:false});case 29:case\"end\":return _context2.stop();}}},_callee2,this);}));function fetchData(){return _fetchData.apply(this,arguments);}return fetchData;}()},{key:\"render\",value:function render(){return/*#__PURE__*/React.createElement(\"div\",{className:classes.background},/*#__PURE__*/React.createElement(\"div\",{className:classes.cube}),/*#__PURE__*/React.createElement(\"div\",{className:classes.cube}),/*#__PURE__*/React.createElement(\"div\",{className:classes.cube}),/*#__PURE__*/React.createElement(\"div\",{className:classes.cube}),/*#__PURE__*/React.createElement(\"div\",{className:classes.cube}),/*#__PURE__*/React.createElement(\"div\",{className:classes.cube}),this.state.loading?/*#__PURE__*/React.createElement(\"div\",{id:\"loader\",className:\"text-center mt-5\"},/*#__PURE__*/React.createElement(\"p\",null,\"Loading...\")):/*#__PURE__*/React.createElement(Container,{fluid:true,className:classes.containerFluid},/*#__PURE__*/React.createElement(Row,{className:classes.rowFinder},/*#__PURE__*/React.createElement(Col,{lg:6,className:classes.containerPost},!this.props.input?/*#__PURE__*/React.createElement(\"div\",null):/*#__PURE__*/React.createElement(Form,{address:this.props.input}),/*#__PURE__*/React.createElement(PostList,{posts:this.state.posts})),/*#__PURE__*/React.createElement(Col,{lg:6},\" \"))));}}]);return PostSection;}(Component);export default PostSection;","map":{"version":3,"sources":["C:/Users/VASILISVITTIS/Documents/main/src/components/posts/PostSection.js"],"names":["classes","React","Component","useEffect","Web3","Container","Col","FloatingLabel","FormControl","Row","CardFormatter","Blog","PostList","NavigationBar","Banner","Form","PostSection","props","state","userConnected","blogPost","postCount","posts","loading","fetchData","window","ethereum","web3","console","log","eth","net","getId","networkId","toString","networkData","networks","Contract","abi","address","setState","methods","call","i","post","sort","a","b","tipAmount","background","cube","containerFluid","rowFinder","containerPost","input"],"mappings":"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","sourcesContent":["import classes from './PostSection.module.css'\r\nimport React, {Component, useEffect} from 'react'\r\nimport Web3 from 'web3';\r\nimport {Container, Col, FloatingLabel, FormControl, Row} from 'react-bootstrap'\r\nimport CardFormatter from \"../ui/CardFormatter\";\r\nimport Blog from '../../abis/Blog.json'\r\nimport PostList from \"./PostList\";\r\nimport NavigationBar from \"../layout/Navbar\";\r\nimport Banner from \"../layout/Banner\";\r\nimport Form from \"../ui/Form\";\r\n\r\n\r\nclass PostSection extends Component<{ account?: string }> {\r\n\r\n    async componentWillMount() {\r\n        await this.fetchData()\r\n    }\r\n\r\n    constructor(props) {\r\n        super(props)\r\n        this.state = {\r\n            userConnected: false,\r\n            blogPost: null,\r\n            postCount: 0,\r\n            posts: [],\r\n            loading: true\r\n        }\r\n\r\n        // this.createPost = this.createPost.bind(this)\r\n        // this.tipPost = this.tipPost.bind(this)\r\n    }\r\n\r\n    async fetchData() {\r\n\r\n        if (window.ethereum) {\r\n            window.web3 = new Web3(window.ethereum)\r\n            // } else if (window.web3) {\r\n            //     window.web3 = new Web3(window.web3.currentProvider)\r\n            // }\r\n            console.log('use effect')\r\n            const web3 = window.web3\r\n            const networkId = await web3.eth.net.getId()\r\n            console.log(networkId.toString())\r\n            const networkData = Blog.networks[networkId]\r\n            console.log(networkData)\r\n            if (networkData) {\r\n                const blogPost = new web3.eth.Contract(Blog.abi, networkData.address)\r\n                this.setState({blogPost})\r\n                const postCount = await blogPost.methods.postCount().call()\r\n                this.setState({postCount})\r\n                console.log(\"Number of Posts: \" + postCount)\r\n                // Load Posts\r\n                for (var i = 1; i <= postCount; i++) {\r\n                    const post = await blogPost.methods.posts(i).call()\r\n                    this.setState({\r\n                        posts: [...this.state.posts, post]\r\n                    })\r\n                }\r\n                // Sort posts. Show highest tipped posts first\r\n                this.setState({\r\n                    posts: this.state.posts.sort((a, b) => b.tipAmount - a.tipAmount)\r\n                })\r\n                this.setState({loading: false})\r\n            }\r\n        }\r\n    }\r\n\r\n    render() {\r\n\r\n        return (\r\n\r\n            <div className={classes.background}>\r\n                <div className={classes.cube}/>\r\n                <div className={classes.cube}/>\r\n                <div className={classes.cube}/>\r\n                <div className={classes.cube}/>\r\n                <div className={classes.cube}/>\r\n                <div className={classes.cube}/>\r\n\r\n                {this.state.loading ? <div id=\"loader\" className=\"text-center mt-5\"><p>Loading...</p></div>\r\n                    :\r\n                    (<Container fluid className={classes.containerFluid}>\r\n\r\n                            <Row className={classes.rowFinder}>\r\n                                <Col lg={6} className={classes.containerPost}>\r\n\r\n                                    {!this.props.input ? <div/>\r\n                                        :\r\n                                        <Form address={this.props.input}/>\r\n                                    }\r\n                                    <PostList  posts={this.state.posts}/>\r\n\r\n                                </Col>\r\n                                <Col lg={6}> </Col>\r\n                            </Row>\r\n                        </Container>\r\n\r\n                    )\r\n\r\n                }\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nexport default PostSection"]},"metadata":{},"sourceType":"module"}